import OpenAI from "openai";

export async function POST(req) {
  const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

  const { nome, progresso } = await req.json();

  const prompt = `
    Gere uma notificação amigável e motivacional para o usuário ${nome}.
    Ele está ${progresso}% perto de bater sua meta mensal.
  `;

  const res = await client.responses.create({
    model: "gpt-4.1-mini",
    input: prompt,
  });

  return new Response(JSON.stringify({ message: res.output_text }), {
    headers: { "Content-Type": "application/json" },
  });
}
